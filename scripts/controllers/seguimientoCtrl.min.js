app.controller("seguimientoCtrl",["$scope","$modal","productosService","AlertService","$filter",function(o,n,e){return o.alerts=[],o.p={mod_options:[]},o.movimientos=[],o.form={},o.form.idModelo="",o.form.modelo={nombre:"",id:""},hoy=formatLocalDate(),o.desde=hoy,o.hasta=hoy,o.search=function(){""!=o.form.idModelo&&e.getProductoModelo(o.form.idModelo).then(function(i){o.form.modelo=i.data.DATA},function(i){(403==i.status||401==i.status)&&($modalInstance.dismiss({action:"cancel"}),$location.path("/index")),o.form.modelo.nombre=""})},o.searchByName=function(){""!=o.form.modelo.nombre&&e.getProductoModeloByName(o.form.modelo.nombre).then(function(i){o.p.mod_options=i.data.DATA},function(){o.p.mod_options=[]})},o.setModel=function(i){o.form.modelo=i,o.form.idModelo=i.id},o.mostrarMovimientos=function(){o.parar=!1,o.movimientos=[],o.page=0,""!=o.form.idModelo&&o.cargar()},o.page=0,o.movimientos=[],o.parar=!1,o.pending=!1,o.cargar=function(){o.page++,o.pending=!0,e.movimientos(o.form.idModelo,o.desde,o.hasta,o.page).then(function(n){if(null!=n.data.DATA&n.data.DATA.movimientos.length>0)for(i=0;i<n.data.DATA.movimientos.length;i++)o.movimientos.push(n.data.DATA.movimientos[i]);else o.movimientos.length>0&&$(".finMovimientos").html('<div class="fin"></div>'),o.parar=!0;o.pending=!1},function(){o.pending=!1,o.parar=!0})},$("#infinite-scrolling").size()>0?void $(window).on("scroll",function(){$(window).scrollTop()>$(document).height()-$(window).height()-60&!o.parar&!o.pending&&o.movimientos.length>0&&o.cargar()}):void 0}]);