app.controller("gastosCtrl",["$scope","$modal","gastosService","AlertService","$filter","AuthService","$location",function(t,a,e,o,i,n,r){t.alerts=[],hoy=formatLocalDate(),t.fps=[{label:"Efectivo",value:"Efectivo"},{label:"Tarjeta",value:"Tarjeta"},{label:"Cheque",value:"Cheque"},{label:"Débito",value:"Debito"},{label:"Transferencia",value:"Transferencia"}],t.gasto={created:hoy,descripcion:"",monto:"",FP:"Efectivo"},t.desde=hoy,t.hasta=hoy,t.cat_options=[],t.catFilter_options=[],t.categoria={id:"",nombre:""},t.categoriaFilter_id="",t.categoriaFilter={nombre:"",id:""},t.cargar=function(){""==t.categoriaFilter.nombre&&(t.categoriaFilter_id=""),e.gastos(t.desde,t.hasta,t.categoriaFilter_id).then(function(a){t.gastos=a.data.DATA},function(){n.logout(),r.path("/login")})},t.searchCategoriaFilterByName=function(){""!=t.categoriaFilter.nombre&&e.getCategoriasByName(t.categoriaFilter.nombre).then(function(a){t.catFilter_options=a.data.DATA},function(a){(403==a.status||401==a.status)&&r.path("/login"),t.catFilter_options=[]})},t.setCategoriaFilter=function(a){t.categoriaFilter_id=a.id},t.searchCategoriaByName=function(){""!=t.categoria.nombre?e.getCategoriasByName(t.categoria.nombre).then(function(a){t.cat_options=a.data.DATA},function(a){(403==a.status||401==a.status)&&r.path("/login"),t.cat_options=[]}):t.gasto.categoria=null},t.setCategoria=function(a){t.gasto.categoria=a},t.addGasto=function(){""!=t.gasto.categoria&""!=t.gasto.monto?e.addGasto(t.gasto).then(function(a){t.gastos.splice(0,0,a.data.DATA),angular.element("#monto").focus(),angular.element("#descripcion").val(""),angular.element("#monto").val(""),angular.element("#categoria").val(""),t.gasto={created:hoy,descripcion:"",monto:"",FP:"Efectivo",categoria:""}},function(t){o.add("danger",t.data.MSG)}):o.add("danger","Debe completar los datos del gasto.",1e3)},t.removeGasto=function(i){var n={msj:"¿Está seguro que desea eliminar este gasto?",accept:"Si",cancel:"No"},r=a.open({templateUrl:dir_root+"/templates/confirm.html",windowClass:"wndConfirm",controller:"modalConfirmCtrl",resolve:{txt:function(){return n}}});r.result.then(function(){e.deleteGasto(t.gastos[i].id).then(function(){t.gastos.splice(i,1)},function(t){o.add("danger",t.data.MSG)})},function(){})},t.cargar()}]);